<% if(typeof inputname != "string" || !inputname) { inputname = false; } %>
<style>
#popup-dimmer {
  width: 100%;
  height: 100%;
  background: transparent;
  visibility: collapse;
  position: fixed;
  top: 0;
  z-index: 12;
  transition: .2s;
}
#popup-dimmer.shown {
  background: rgba(0, 0, 0, 0.7);
  visibility: visible;
}
#popup {
  width: 500px;
  height: 400px;
  position: fixed;
  left: calc(50vw - 250px);
  padding-top: 12px;
  background-color: #fff;
  border-radius: 3px;
  text-align: center;
  list-style-type: none;
  opacity: 0;
  top: calc(40% - 100px);
  transition: .2s;
}
#popup-dimmer.shown #popup {
  top: calc(45% - 100px);
  opacity: 1;
}
#popup #header {
  font-weight: 300;
  font-size: 34px;
  margin: 0;
}
#popup #message {
  /* TODO(eforde): allow this to be multiline */
  color: #555;
  margin-bottom: 16px;
  text-align: left;
}
#popup input {
  border: 0;
  width: calc(100% - 48px);
  font-size: 18px;
  padding: 12px;
  margin: 12px 12px 4px 12px;
  border-bottom: solid 1px;
  border-bottom-color: #e5e5e5;
  background: rgba(255, 255, 255, 0.95);
  transition: .2s all;
}
#popup input:focus {
  outline: none;
  border-bottom-color: #4e4e9d;
}
#popup input.invalid {
  border-bottom-color: red;
}
#buttons {
  width: 100%;
  position: absolute;
  bottom: 0;
}
#buttons p {
  font-size: 18px;
  padding-top: 12px;
  padding-bottom: 12px;
  width: 50%;
  float: left;
  font-weight: 100;
  transition: .2s;
  color: white;
  cursor: pointer;
  transform-origin: 0 100%;
}
#cancel-button {
  background-color: #ccc;
}
#cancel-button:hover {
  transform: scaleY(1.02);
  background-color: #bbb;
}
#confirm-button {
  background-color: #4e4e9d;
}
#confirm-button:hover {
  transform: scaleY(1.02);
  background-color: #48488f;
}
</style>

<div id="popup-dimmer">
    <div id="popup">
        <h1 id="header">header</h1>
        <span id="message">message</span>
        <% if (inputname) { %>
        <input name="input" id="input" type="text" placeholder="inputname" />
        <% } %>
        <div id="buttons">
            <p id="cancel-button">cancel</p>
            <p id="confirm-button">confirm</p>
        </div>
    </div>
</div>

<script>
var callback;

function showPopup(header, msg, inputname, _callback) {
  $("#header").text(header);
  $("#message").text(msg);
  $("#input").attr("placeholder", inputname);
  $("#input").removeClass("invalid");
  $("#input").attr("value", "");
  $('#popup-dimmer').addClass('shown');
  $("#input").focus();
  callback = _callback;
}

$("#new-station-name").keyup(function(e){
  if(e.which == 13)
      $("#create-button").click();
});

$("#confirm-button").click(function() {
  if ($("#input").length) {
    let input = $("#input").attr("value").trim();
    if (input == "") {
      $("#input").addClass("invalid");
      return;
    }
    $("#popup-dimmer").removeClass("shown");
    callback({success: true, input});
    return;
  }
  $("#popup-dimmer").removeClass("shown");
  callback({success: true});
});

$("#popup-dimmer, #cancel-button").click(function(e) {
	if (e.target !== this)
		return;
	$("#popup-dimmer").removeClass("shown");
  callback({success: false});
});
</script>